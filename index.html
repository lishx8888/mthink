<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>思维导图应用</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="images/icon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="images/icon.ico" type="image/x-icon">
    <link rel="stylesheet" href="css/font-awesome.min.css">
</head>
<body>
    <div class="container">



        <!-- 自定义导出弹窗 -->
        <div id="exportDialog" class="save-dialog">
            <div class="save-dialog-content">
                <div class="save-dialog-header">
                    <h3>导出思维导图</h3>
                    <button id="closeExportDialog" class="close-button">&times;</button>
                </div>
                <div class="save-dialog-body">
                    <div class="save-option">
                        <label for="exportFormatSelect">导出格式:</label>
                        <select id="exportFormatSelect">
                            <option value="svg" selected>SVG</option>
                            <option value="png">PNG</option>
                            <option value="markdown">Markdown</option>
                        </select>
                    </div>
                    <div class="save-option">
                        <label for="fileNameInput">文件名:</label>
                        <input type="text" id="fileNameInput" value="mindmap" placeholder="输入文件名">
                    </div>
                </div>
                <div class="save-dialog-footer">
                    <button id="cancelExport" class="cancel-button">取消</button>
                    <button id="confirmExport" class="confirm-button">导出</button>
                </div>
            </div>
        </div>

        <!-- 主区域 -->
        <div class="main-area">
            <!-- SVG画布区域 -->
            <div class="canvas-container">
                <svg id="mindMapCanvas" width="100%" height="100%"></svg>
                <!-- 缩略图画布 -->
                <svg id="thumbnailCanvas" class="thumbnail-canvas"></svg>
            </div>
            
            <!-- 样式面板 -->
            <div class="style-panel">
                <div class="style-group">
                    <div class="file-control">
                        <label>文件</label>
                        <div class="panel-controls">
                            <button id="saveMap" class="panel-button center-node-btn" title="保存">
                                <i class="fa fa-save"></i>
                            </button>
                            <button id="loadMap" class="panel-button center-node-btn" title="加载">
                                <i class="fa fa-folder-open-o"></i>
                            </button>
                            <button id="exportMap" class="panel-button center-node-btn" title="导出">
                                <i class="fa fa-sign-out"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="divider"></div>
                <div class="style-group">
                    <div class="node-control">
                        <label>节点</label>
                        <div class="panel-controls">
                            <div class="panel-control-group real-time-layout-container">
                                <button id="centerNode" class="panel-button center-node-btn" title="中心节点">
                                    <i class="fa fa-arrows"></i>
                                </button>
                                <button id="autoLayout" class="panel-button center-node-btn" title="手动布局">
                                    <img src="images/布局.svg" alt="布局" style="width: 20px; height: 20px;">
                                </button>
                                <label title="实时布局" style="width: 50px; height: 36px; position: relative; display: inline-flex; align-items: center; justify-content: center; cursor: pointer;"><input type="checkbox" id="realTimeLayoutToggle" checked style="opacity: 0; width: 0; height: 0;"><span id="track" style="position: absolute; top: 50%; left: 0; right: 0; height: 28px; background-color: #444; border-radius: 14px; transition: .4s; transform: translateY(-50%);"></span><span id="knob" style="position: absolute; content: ''; top: 50%; left: 2px; width: 24px; height: 24px; background-color: white; border-radius: 50%; transition: .4s; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2); transform: translate(24px, -50%);"></span><script>document.getElementById('realTimeLayoutToggle').addEventListener('change', function() {var track = document.getElementById('track'); var knob = document.getElementById('knob'); if (this.checked) {track.style.backgroundColor = '#444'; knob.style.transform = 'translate(24px, -50%)';} else {track.style.backgroundColor = '#e0e0e0'; knob.style.transform = 'translate(0, -50%)';}});</script></label>
                                <button id="handToolToggle" class="panel-button center-node-btn" title="手形工具" style="background-color: #c0c0c0;">
                                    <img src="images/手形.svg" alt="手形工具" style="width: 20px; height: 20px;">
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="divider"></div>

                <!-- 颜色设置组 - 两行两列布局 -->
                <div class="style-group">
                    <div class="color-control">
                        <label for="nodeColor">背景</label>
                        <div class="color-palette" data-target="nodeColor">
                        <div class="color-swatches-container">
                            <span class="color-swatch" style="background-color: #ffffff"></span>
                            <span class="color-swatch" style="background-color: #f0f8ff"></span>
                            <span class="color-swatch" style="background-color: #faebd7"></span>
                            <span class="color-swatch" style="background-color: #7fffd4"></span>
                            <span class="color-swatch" style="background-color: #f0ffff"></span>
                            <span class="color-swatch" style="background-color: #f5f5dc"></span>
                            <span class="color-swatch" style="background-color: #ffe4c4"></span>
                            <span class="color-swatch" style="background-color: #ffebcd"></span>
                            <span class="color-swatch" style="background-color: #ff7f50"></span>
                            <span class="color-swatch" style="background-color: #ffff00"></span>
                            <span class="color-swatch" style="background-color: #90ee90"></span>
                            <span class="color-swatch" style="background-color: #add8e6"></span>
                        </div>
                        <input type="color" id="nodeColor" value="#ffffff" class="custom-color-picker">
                        </div>
                    </div>
                </div>
                <div class="divider"></div>
                <div class="style-group" id="borderSettings">
                    <div class="font-control">
                        <label>边框</label>
                        <div class="font-items">
                            <div class="font-row">
                                <div class="font-family-group">
                                    <select id="borderStyle" title="边框样式">
                                        <option value="none">无边框</option>
                                        <option value="solid">实线</option>
                                        <option value="dashed">虚线</option>
                                        <option value="dotted">点线</option>
                                    </select>
                                </div>
                                <div class="font-size-group">
                                    <input type="number" id="borderWidth" value="1" min="1" max="10" title="边框宽度">
                                </div>
                            </div>
                            <div class="font-color-group">
                                <div class="color-palette" data-target="borderColor">
                                    <div class="color-swatches-container">
                                        <span class="color-swatch" style="background-color: #000000"></span>
                                        <span class="color-swatch" style="background-color: #ffffff"></span>
                                        <span class="color-swatch" style="background-color: #808080"></span>
                                        <span class="color-swatch" style="background-color: #a9a9a9"></span>
                                        <span class="color-swatch" style="background-color: #ff0000"></span>
                                        <span class="color-swatch" style="background-color: #0000ff"></span>
                                        <span class="color-swatch" style="background-color: #008000"></span>
                                        <span class="color-swatch" style="background-color: #800080"></span>
                                        <span class="color-swatch" style="background-color: #ff8c00"></span>
                                        <span class="color-swatch" style="background-color: #ffd700"></span>
                                        <span class="color-swatch" style="background-color: #4169e1"></span>
                                        <span class="color-swatch" style="background-color: #32cd32"></span>
                                    </div>
                                    <input type="color" id="borderColor" value="#000000" class="custom-color-picker">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="divider"></div>

                <div class="style-group">
                    <div class="color-control">
                        <label for="connectionColor">线条</label>
                        <div class="color-palette" data-target="connectionColor">
                        <div class="color-swatches-container">
                            <span class="color-swatch" style="background-color: #000000"></span>
                            <span class="color-swatch" style="background-color: #808080"></span>
                            <span class="color-swatch" style="background-color: #a9a9a9"></span>
                            <span class="color-swatch" style="background-color: #ff0000"></span>
                            <span class="color-swatch" style="background-color: #0000ff"></span>
                            <span class="color-swatch" style="background-color: #008000"></span>
                            <span class="color-swatch" style="background-color: #800080"></span>
                            <span class="color-swatch" style="background-color: #ff00ff"></span>
                            <span class="color-swatch" style="background-color: #ff8c00"></span>
                            <span class="color-swatch" style="background-color: #ffd700"></span>
                            <span class="color-swatch" style="background-color: #4169e1"></span>
                            <span class="color-swatch" style="background-color: #32cd32"></span>
                        </div>
                        <input type="color" id="connectionColor" value="#000000" class="custom-color-picker">
                        </div>
                    </div>
                </div>
                <div class="divider"></div>
                <!-- 节点形状选择器 -->
                <div class="style-group">
                    <div class="shape-control">
                        <label>形状</label>
                        <div class="shape-picker">
                            <div class="shape-option" data-shape="track" title="跑道形">
                                <svg width="60" height="30" viewBox="0 0 60 30">
                                    <path d="M15 0 L45 0 A15 15 0 0 1 60 15 L60 15 A15 15 0 0 1 45 30 L15 30 A15 15 0 0 1 0 15 L0 15 A15 15 0 0 1 15 0 Z" fill="#ffffff" stroke="#000000" stroke-width="1"></path>
                                </svg>
                            </div>
                            <div class="shape-option" data-shape="rounded-rect" title="圆角矩形">
                                <svg width="60" height="30" viewBox="0 0 60 30">
                                    <rect x="0" y="0" width="60" height="30" rx="8" ry="8" fill="#ffffff" stroke="#000000" stroke-width="1"></rect>
                                </svg>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="divider"></div>
                <!-- 字体设置组 - 整合所有字体相关设置 -->
                <div class="style-group" id="fontSettings">
                    <div class="font-control">
                        <label>文字</label>
                        <div class="font-items">
                            <div class="font-row">
                                <div class="font-family-group">
                                    <select id="fontFamily" title="字体">
                                        <option value="Arial">Arial</option>
                                        <option value="微软雅黑">微软雅黑</option>
                                        <option value="宋体">宋体</option>
                                        <option value="黑体">黑体</option>
                                        <option value="Times New Roman">Times New Roman</option>
                                    </select>
                                </div>
                                <div class="font-size-group">
                                    <input type="number" id="fontSize" value="14" min="8" max="36" title="字号">
                                </div>
                            </div>
                            <div class="text-align-group" title="文本对齐">
                                <div class="text-align-options">
                                    <button type="button" class="text-align-option" data-align="left" title="左对齐">
                                        <svg width="20" height="20" viewBox="0 0 20 20">
                                            <line x1="2" y1="4" x2="18" y2="4" stroke="currentColor" stroke-width="2"/>
                                            <line x1="2" y1="8" x2="14" y2="8" stroke="currentColor" stroke-width="2"/>
                                            <line x1="2" y1="12" x2="18" y2="12" stroke="currentColor" stroke-width="2"/>
                                            <line x1="2" y1="16" x2="10" y2="16" stroke="currentColor" stroke-width="2"/>
                                        </svg>
                                    </button>
                                    <button type="button" class="text-align-option" data-align="center" title="居中">
                                        <svg width="20" height="20" viewBox="0 0 20 20">
                                            <line x1="2" y1="4" x2="18" y2="4" stroke="currentColor" stroke-width="2"/>
                                            <line x1="4" y1="8" x2="16" y2="8" stroke="currentColor" stroke-width="2"/>
                                            <line x1="2" y1="12" x2="18" y2="12" stroke="currentColor" stroke-width="2"/>
                                            <line x1="5" y1="16" x2="15" y2="16" stroke="currentColor" stroke-width="2"/>
                                        </svg>
                                    </button>
                                    <button type="button" class="text-align-option" data-align="right" title="右对齐">
                                        <svg width="20" height="20" viewBox="0 0 20 20">
                                            <line x1="2" y1="4" x2="18" y2="4" stroke="currentColor" stroke-width="2"/>
                                            <line x1="6" y1="8" x2="18" y2="8" stroke="currentColor" stroke-width="2"/>
                                            <line x1="2" y1="12" x2="18" y2="12" stroke="currentColor" stroke-width="2"/>
                                            <line x1="10" y1="16" x2="18" y2="16" stroke="currentColor" stroke-width="2"/>
                                        </svg>
                                    </button>
                                    <input type="hidden" id="textAlign" value="left">
                                </div>
                            </div>
                            <div class="font-color-group">
                                <div class="color-palette" data-target="fontColor">
                                    <div class="color-swatches-container">
                                        <span class="color-swatch" style="background-color: #000000"></span>
                                        <span class="color-swatch" style="background-color: #333333"></span>
                                        <span class="color-swatch" style="background-color: #666666"></span>
                                        <span class="color-swatch" style="background-color: #999999"></span>
                                        <span class="color-swatch" style="background-color: #ff0000"></span>
                                        <span class="color-swatch" style="background-color: #0000ff"></span>
                                        <span class="color-swatch" style="background-color: #008000"></span>
                                        <span class="color-swatch" style="background-color: #800080"></span>
                                        <span class="color-swatch" style="background-color: #ff8c00"></span>
                                        <span class="color-swatch" style="background-color: #ff00ff"></span>
                                        <span class="color-swatch" style="background-color: #4b0082"></span>
                                        <span class="color-swatch" style="background-color: #8b4513"></span>
                                    </div>
                                    <input type="color" id="fontColor" value="#000000" class="custom-color-picker">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 自定义颜色选择器 -->
    <div id="customColorPicker" class="custom-color-picker-panel">
        <!-- 颜色渐变区域 -->
        <div id="colorGradient" class="color-gradient">
            <div id="colorPicker" class="color-picker"></div>
            <div id="colorPickerDot" class="color-picker-dot"></div>
        </div>
        
        <!-- 彩虹色条 -->
        <div id="rainbowBar" class="rainbow-bar">
            <div id="rainbowPicker" class="rainbow-picker"></div>
            <div id="rainbowPickerDot" class="rainbow-picker-dot"></div>
        </div>
        
        <!-- RGB输入 -->
        <div class="rgb-inputs">
            <div class="rgb-input">
                <input type="number" id="rInput" min="0" max="255" value="255">
                <label>R</label>
            </div>
            <div class="rgb-input">
                <input type="number" id="gInput" min="0" max="255" value="255">
                <label>G</label>
            </div>
            <div class="rgb-input">
                <input type="number" id="bInput" min="0" max="255" value="255">
                <label>B</label>
            </div>
        </div>
        
        <!-- 颜色预览和关闭按钮 -->
        <div class="color-preview-area">
            <div id="colorPreview" class="color-preview-box"></div>
            <button id="closeColorPicker" class="close-button">&times;</button>
        </div>
    </div>
    
    <!-- 右侧栏显隐控制按钮容器 -->
    <div class="toggle-style-panel-container">
        <!-- 主题切换开关 -->
        <button id="themeToggle" class="toggle-style-panel-btn theme-toggle-btn" title="切换主题">
            <!-- 白天模式图标 -->
            <svg class="theme-icon sun-icon" stroke-width="2" color="currentColor" style="overflow: visible;" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M12 7A5 5 0 1 0 12 17 5 5 0 1 0 12 7z"></path><path d="M12 1 12 3"></path><path d="M12 21 12 23"></path><path d="M4.22 4.22 5.64 5.64"></path><path d="M18.36 18.36 19.78 19.78"></path><path d="M1 12 3 12"></path><path d="M21 12 23 12"></path><path d="M4.22 19.78 5.64 18.36"></path><path d="M18.36 5.64 19.78 4.22"></path></svg>
            <!-- 夜间模式图标 -->
            <svg class="theme-icon moon-icon" stroke-width="2" color="currentColor" style="overflow: visible;" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
        </button>
        <button id="toggleStylePanelBtn" class="toggle-style-panel-btn" title="显隐右侧栏">
            右
        </button>
    </div>
    
    <script src="script.js"></script>

<!-- 右侧栏显隐控制脚本 -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const toggleStylePanelBtn = document.getElementById('toggleStylePanelBtn');
    if (toggleStylePanelBtn) {
        toggleStylePanelBtn.addEventListener('click', function() {
            const stylePanel = document.querySelector('.style-panel');
            if (stylePanel) {
                if (stylePanel.style.display === 'none') {
                    stylePanel.style.display = 'block';
                } else {
                    stylePanel.style.display = 'none';
                }
            }
        });
    }
});
</script>
</body>
</html>